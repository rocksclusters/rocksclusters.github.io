<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>7.2 Setting up Condor</TITLE>
<META NAME="description" CONTENT="7.2 Setting up Condor">
<META NAME="keywords" CONTENT="ref">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ref.css">

<LINK REL="next" HREF="7_3Running_Condor.html">
<LINK REL="previous" HREF="7_1Obtaining.html">
<LINK REL="up" HREF="7_Frequently_Asked.html">
<LINK REL="next" HREF="7_3Running_Condor.html">
</HEAD>

<BODY  BGCOLOR=#FFFFFF >
<!--Navigation Panel-->
<A NAME="tex2html2028"
  HREF="7_3Running_Condor.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2022"
  HREF="7_Frequently_Asked.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2016"
  HREF="7_1Obtaining.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2024"
  HREF="Contents.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html2026"
  HREF="Index.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html2029"
  HREF="7_3Running_Condor.html">7.3 Running Condor Jobs</A>
<B> Up:</B> <A NAME="tex2html2023"
  HREF="7_Frequently_Asked.html">7. Frequently Asked Questions</A>
<B> Previous:</B> <A NAME="tex2html2017"
  HREF="7_1Obtaining.html">7.1 Obtaining &amp; Installing</A>
 &nbsp; <B>  <A NAME="tex2html2025"
  HREF="Contents.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html2027"
  HREF="Index.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html2030"
  HREF="7_2Setting_up.html#SECTION00821000000000000000">How do I set up a central manager on a machine with multiple network interfaces?</A>
<LI><A NAME="tex2html2031"
  HREF="7_2Setting_up.html#SECTION00822000000000000000">How do I get more than one job to run on my SMP machine?</A>
<LI><A NAME="tex2html2032"
  HREF="7_2Setting_up.html#SECTION00823000000000000000">How do I configure a separate policy for the CPUs of an SMP machine?</A>
<LI><A NAME="tex2html2033"
  HREF="7_2Setting_up.html#SECTION00824000000000000000">How do I set up my machines so that only specific users' jobs will run on them?</A>
<LI><A NAME="tex2html2034"
  HREF="7_2Setting_up.html#SECTION00825000000000000000">How do I configure Condor to run my jobs only on machines that have the right packages installed?</A>
<LI><A NAME="tex2html2035"
  HREF="7_2Setting_up.html#SECTION00826000000000000000">How do I configure Condor to only run jobs at night?</A>
<LI><A NAME="tex2html2036"
  HREF="7_2Setting_up.html#SECTION00827000000000000000">How do I configure Condor such that all machines do not produce checkpoints at the same time?</A>
<LI><A NAME="tex2html2037"
  HREF="7_2Setting_up.html#SECTION00828000000000000000">Why will the <I>condor_master</I> not run when a local configuration file is missing?</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00820000000000000000">
7.2 Setting up Condor</A>
</H1>

<P>

<H2><A NAME="SECTION00821000000000000000">
How do I set up a central manager on a machine with multiple network interfaces?</A>
</H2>

<P>
Please see section&nbsp;<A HREF="3_7Networking_includes.html#sec:Multiple-Interfaces">3.7.3</A> on 
page&nbsp;<A HREF="3_7Networking_includes.html#sec:Multiple-Interfaces"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>.

<P>

<H2><A NAME="SECTION00822000000000000000">
How do I get more than one job to run on my SMP machine?</A>
</H2>

<P>
Condor will automatically recognize a SMP machine and advertise each
CPU of the machine separately.
For more details, see section&nbsp;<A HREF="3_13Setting_Up.html#sec:Configuring-SMP">3.13.9</A> on
page&nbsp;<A HREF="3_13Setting_Up.html#sec:Configuring-SMP"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>.

<P>

<H2><A NAME="SECTION00823000000000000000">
How do I configure a separate policy for the CPUs of an SMP machine?</A>
</H2>

<P>
Please see section&nbsp;<A HREF="3_13Setting_Up.html#sec:Configuring-SMP">3.13.9</A> on
page&nbsp;<A HREF="3_13Setting_Up.html#sec:Configuring-SMP"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A> for a lengthy discussion on
this topic.

<P>

<H2><A NAME="SECTION00824000000000000000"></A>
<A NAME="49616"></A>
<BR>
How do I set up my machines so that only specific users' jobs will run on them?
</H2>

<P>
Restrictions on what jobs will run on a given resource are
enforced by only starting jobs that meet specific constraints,
and these constraints are specified as part of the configuration.

<P>
To specify that a given machine should only run certain users' jobs,
and always run the jobs regardless of other activity on the machine,
load average, etc.,
place the following entry in the
machine's Condor configuration file:

<P>
<PRE>
START = ( (RemoteUser == "userfoo@baz.edu") || \
          (RemoteUser == "userbar@baz.edu") )
</PRE>
<P>
A more likely scenario is that the machine is restricted to run
only specific users' jobs, contingent on the machine not having
other interactive activity and not being heavily loaded.
The following entries are in the machine's Condor configuration file. 
Note that extra configuration variables are defined to make 
the <TT>START</TT> variable easier to read.

<P>
<PRE>
# Only start jobs if:
# 1) the job is owned by the allowed users, AND
# 2) the keyboard has been idle long enough, AND
# 3) the load average is low enough OR the machine is currently
#    running a Condor job, and would therefore accept running
#    a different one
AllowedUser    = ( (RemoteUser == "userfoo@baz.edu") || \
                   (RemoteUser == "userbar@baz.edu") )
KeyboardUnused = (KeyboardIdle &gt; $(StartIdleTime))
NoOwnerLoad    = ($(CPUIdle) || (State != "Unclaimed" &amp;&amp; State != "Owner"))
START          = $(AllowedUser) &amp;&amp; $(KeyboardUnused) &amp;&amp; $(NoOwnerLoad)
</PRE>
<P>
To configure multiple machines to do so, create a common
configuration file containing this entry for them to share.

<P>

<H2><A NAME="SECTION00825000000000000000">
How do I configure Condor to run my jobs only on machines that have the right packages installed?</A>
</H2>

<P>
This is a two-step process.
First, you need to tell the machines to report that they have special
software installed, and second, you need to tell the jobs to require
machines that have that software.

<P>
To tell the machines to report the presence of special software, first
add a parameter to their configuration files like so:

<P>
<PRE>
HAS_MY_SOFTWARE = True
</PRE>

<P>
And then, if there are already <TT>STARTD_ATTRS</TT> defined in that file, add
<TT>HAS_MY_SOFTWARE</TT> to them, or, if not, add the line:

<P>
<PRE>
STARTD_ATTRS = HAS_MY_SOFTWARE, $(STARTD_ATTRS)
</PRE>
<P>
<U>NOTE</U>: For these changes to take effect, each <I>condor_startd</I> you update
needs to be reconfigured with <I>condor_reconfig</I> -startd.

<P>
Next, to tell your jobs to only run on machines that have this
software, add a requirements statement to their submit files like so:

<P>
<PRE>
Requirements = (HAS_MY_SOFTWARE =?= True)
</PRE>
<P>
<U>NOTE</U>: Be sure to use =?= instead of == so that if a machine doesn't have
the HAS_MY_SOFTWARE parameter defined, the job's Requirements
expression will not evaluate to ``undefined'', preventing it from
running anywhere!

<P>

<H2><A NAME="SECTION00826000000000000000"></A>
<A NAME="49634"></A>
<A NAME="49635"></A>
<BR>
How do I configure Condor to only run jobs at night?
</H2>

<P>
A commonly requested policy for running batch jobs is to only allow
them to run at night, or at other pre-specified times of the day.
Condor allows you to configure this policy with the use of the
<TT>ClockMin</TT> and <TT>ClockDay</TT> <I>condor_startd</I> attributes.  
A complete example of how to use these attributes for this kind of
policy is discussed in subsubsection&nbsp;<A HREF="3_5Policy_Configuration.html#sec:Time_of_Day_Policy">3.5.9</A> on
page&nbsp;<A HREF="3_5Policy_Configuration.html#sec:Time_of_Day_Policy"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>.

<P>

<H2><A NAME="SECTION00827000000000000000"></A>
<A NAME="sec:randomintegerusage"></A><A NAME="49643"></A>
<A NAME="49644"></A>
<BR>
How do I configure Condor such that all machines do not produce checkpoints at the same time?
</H2>
If machines are configured to produce checkpoints at fixed intervals,
a large number of jobs are queued (submitted) at the same time,
and these jobs start on machines at about the same time,
then all these jobs will be trying to write out their checkpoints
at the same time.
It is likely to cause rather poor performance during this burst of
writing.

<P>
The <TT>RANDOM_INTEGER()</TT> <A NAME="50131"></A> <A NAME="50132"></A> macro can help in this instance.
Instead of defining <TT>PERIODIC_CHECKPOINT</TT> <A NAME="50136"></A> <A NAME="50137"></A> to be a fixed
interval, each machine is configured to randomly choose 
one of a set of intervals.
For example, to set a machine's interval for producing checkpoints
to within the range of two to three hours, use the following
configuration:
<PRE>
PERIODIC_CHECKPOINT = $(LastCkpt) &gt; ( 2 * $(HOUR) + \
      $RANDOM_INTEGER(0,60,10) * $(MINUTE) )
</PRE>
<P>
The interval used is set at configuration time.
Each machine is randomly assigned a different interval 
(2 hours, 2 hours and 10 minutes, 2 hours and 20 minutes, etc.)
at which to produce checkpoints.
Therefore, the various machines will not all attempt to
produce checkpoints at the same time.

<P>

<H2><A NAME="SECTION00828000000000000000">
Why will the <I>condor_master</I> not run when a local configuration file is missing?</A>
</H2>

<P>
If a <TT>LOCAL_CONFIG_FILE</TT> <A NAME="50143"></A> <A NAME="50144"></A> 
is specified in the global configuration file,
but the specified file does not exist,
the <I>condor_master</I> will not start up, and it prints a variation
of the following example message.

<P>
<PRE>
ERROR: Can't read config file /mnt/condor/hosts/bagel/condor_config.local
</PRE>
<P>
This is not a bug; it is a feature!
Condor has always worked this way on purpose.
There is a potentially
large security hole if Condor is configured to read from a file that
does not exist.
By creating that file, a malicious user could
change all sorts of Condor settings.
This is an easy way
to gain root access to a machine,
where the daemons are running as root.

<P>
The intent is that
if you've set up your global configuration file to read
from a local configuration file, and the local file is not there,
then something is wrong.
It is better for the <I>condor_master</I> to exit right away and
log an error message than to start up.

<P>
If the <I>condor_master</I> continued with the local configuration file
missing, either A) someone could breach security or B) you will have
potentially important configuration information missing.
Consider the example where the local configuration file was on an NFS
partition and the server was down. 
There would be all sorts of
really important stuff in the local configuration file,
and Condor might do bad things if it started without those settings.  

<P>
If supplied it with an empty file, the <I>condor_master</I> works fine.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html2028"
  HREF="7_3Running_Condor.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html2022"
  HREF="7_Frequently_Asked.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html2016"
  HREF="7_1Obtaining.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html2024"
  HREF="Contents.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html2026"
  HREF="Index.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html2029"
  HREF="7_3Running_Condor.html">7.3 Running Condor Jobs</A>
<B> Up:</B> <A NAME="tex2html2023"
  HREF="7_Frequently_Asked.html">7. Frequently Asked Questions</A>
<B> Previous:</B> <A NAME="tex2html2017"
  HREF="7_1Obtaining.html">7.1 Obtaining &amp; Installing</A>
 &nbsp; <B>  <A NAME="tex2html2025"
  HREF="Contents.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html2027"
  HREF="Index.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
condor-admin@cs.wisc.edu
</ADDRESS>
</BODY>
</HTML>
